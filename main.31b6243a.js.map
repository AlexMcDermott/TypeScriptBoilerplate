{"version":3,"sources":["ts/canvas.ts","ts/main.ts"],"names":[],"mappings":"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","file":"main.31b6243a.js","sourceRoot":"../src","sourcesContent":["type RGB = [number, number, number];\n\nexport default class Canvas {\n  public width: number;\n  public height: number;\n  public pixelScaledWidth: number;\n  public pixelScaledHeight: number;\n  public framerate: string = null;\n  private ctx: CanvasRenderingContext2D;\n  private image: ImageData = null;\n  private loop = true;\n  private pixelScale = 1;\n\n  constructor(width = window.innerWidth, height = window.innerHeight) {\n    this.createCanvas(width, height);\n    this.width = this.ctx.canvas.width;\n    this.height = this.ctx.canvas.height;\n    this.pixelScaledWidth = width;\n    this.pixelScaledHeight = height;\n    this.background([255, 255, 255]);\n  }\n\n  public start(draw: () => void) {\n    if (this.loop) {\n      this.calcFramerate(draw);\n      requestAnimationFrame(() => {\n        this.start(draw);\n      });\n    }\n  }\n\n  public noLoop() {\n    this.loop = false;\n  }\n\n  public getColour(): RGB {\n    const hex = this.ctx.fillStyle;\n    if (typeof hex === 'string') {\n      const r = parseInt(hex.substring(1, 3), 16);\n      const g = parseInt(hex.substring(3, 5), 16);\n      const b = parseInt(hex.substring(5), 16);\n      return [r, g, b];\n    }\n  }\n\n  public setColour(colour: RGB) {\n    this.ctx.fillStyle = `rgb(${colour[0]}, ${colour[1]}, ${colour[2]})`;\n    this.ctx.strokeStyle = `rgb(${colour[0]}, ${colour[1]}, ${colour[2]})`;\n  }\n\n  public setPixelScale(scl: number) {\n    this.pixelScale = scl;\n    this.pixelScaledWidth = Math.round(this.width / this.pixelScale);\n    this.pixelScaledHeight = Math.round(this.height / this.pixelScale);\n  }\n\n  public set(x: number, y: number) {\n    if (this.image === null) {\n      this.image = this.ctx.getImageData(0, 0, this.width, this.height);\n    }\n    if (this.pixelScale === 1) {\n      const rgb = this.getColour();\n      const index = y * 4 * this.width + x * 4;\n      this.image.data[index] = rgb[0];\n      this.image.data[index + 1] = rgb[1];\n      this.image.data[index + 2] = rgb[2];\n    } else {\n      this.rect(x * this.pixelScale, y * this.pixelScale, this.pixelScale);\n    }\n  }\n\n  public updatePixels() {\n    if (this.image !== null) {\n      this.ctx.putImageData(this.image, 0, 0);\n      this.image = null;\n    }\n  }\n\n  public setFont(\n    size: number,\n    font = 'serif',\n    vAlign: CanvasTextAlign = 'center',\n    hAlign: CanvasTextBaseline = 'middle'\n  ) {\n    this.ctx.font = `${size}px ${font}`;\n    this.ctx.textAlign = vAlign;\n    this.ctx.textBaseline = hAlign;\n  }\n\n  public text(text: string, x: number, y: number) {\n    this.ctx.fillText(text, x, y);\n  }\n\n  public showFramerate() {\n    if (this.framerate !== null) {\n      this.setColour([255, 255, 255]);\n      this.rect(0, 0, 35, 20);\n      this.setColour([0, 0, 0]);\n      this.setFont(20, 'serif', 'left', 'top');\n      this.text(this.framerate, 0, 0);\n    }\n  }\n\n  public background(colour: RGB) {\n    const temp = this.getColour();\n    this.setColour(colour);\n    this.rect(0, 0, this.width, this.height);\n    this.setColour(temp);\n  }\n\n  public line(x1: number, y1: number, x2: number, y2: number) {\n    this.ctx.beginPath();\n    this.ctx.moveTo(x1, y1);\n    this.ctx.lineTo(x2, y2);\n    this.ctx.stroke();\n  }\n\n  public rect(x: number, y: number, w: number, h = w) {\n    this.ctx.beginPath();\n    this.ctx.rect(x, y, w, h);\n    this.ctx.fill();\n  }\n\n  public circle(x: number, y: number, r: number, a1 = 0, a2 = 2 * Math.PI) {\n    this.ctx.beginPath();\n    this.ctx.arc(x, y, r, a1, a2);\n    this.ctx.fill();\n  }\n\n  private createCanvas(width: number, height: number) {\n    const canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    document.body.appendChild(canvas);\n    this.ctx = canvas.getContext('2d');\n  }\n\n  private calcFramerate(draw: () => void) {\n    const start = performance.now();\n    draw();\n    const end = performance.now();\n    this.framerate = (1 / ((end - start) / 1000)).toFixed(1);\n  }\n}\n","import Canvas from './canvas';\n\nconst cnv = new Canvas();\n\nfunction draw() {\n  cnv.background([255, 255, 255]);\n}\n\ncnv.start(draw);\n"]}